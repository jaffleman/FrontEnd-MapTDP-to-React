(this.webpackJsonpmaptdp=this.webpackJsonpmaptdp||[]).push([[0],{76:function(e,t,a){e.exports=a(92)},81:function(e,t,a){},82:function(e,t,a){},92:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),l=a(22),o=a.n(l),c=(a(81),a(2)),s=a(5),i=a(7),u=a(6),p=(a(82),a(9)),d=a(42),m=a(12),f=a(3),h={session:{},baseBrutData:[],mustLoad:!1,ndToShow:null,alreadyShow:[],modalData:{}};var b=Object(d.b)((function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:h,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"RESET_SESSION":return Object(f.a)(Object(f.a)({},e),{},{session:{},baseBrutData:[]})||e;case"SET_SESSION_DATA":return Object(f.a)(Object(f.a)({},e),{},{session:t.value})||e;case"SET_BASE_DATA":return Object(f.a)(Object(f.a)({},e),{},{baseBrutData:t.value})||e;case"TOGGLE_FAVORITE":var a=-1===e.alreadyShow.indexOf(t.value);return(e.ndToShow!==t.value?Object(f.a)(Object(f.a)({},e),{},{ndToShow:t.value,alreadyShow:a?[].concat(Object(m.a)(e.alreadyShow),[t.value]):Object(m.a)(e.alreadyShow)}):Object(f.a)(Object(f.a)({},e),{},{ndToShow:null}))||e;case"SET_REP_STRUCTURE":return Object(f.a)(Object(f.a)({},e),{},{repStructure:{tab:t.value}})||e;case"SET_REP_RCO":return Object(f.a)(Object(f.a)({},e),{},{repStructure:t.value})||e;case"SHOW_MODAL":return Object(f.a)(Object(f.a)({},e),{},{modalData:Object(f.a)({},t.value)})||e;case"CLOSE_MODAL":return Object(f.a)(Object(f.a)({},e),{},{tdpErr:{showModal:t.value,data:[]}})||e;case"SEND_REGLETTE_VALUE":return Object(f.a)(Object(f.a)({},e),{},{createReglette:!1})||e;case"STORE_TDP_STATE":return Object(f.a)(Object(f.a)({},e),{},{TdpPreviousState:t.value})||e;case"UPDATE_LOADER":return Object(f.a)(Object(f.a)({},e),{},{mustLoad:t.value})||e;case"RESET_APP":return h||e;case"ADD_SAlLE":return Object(f.a)(Object(f.a)({},e),{},{repCreatorData:Object(f.a)(Object(f.a)({},e.repCreatorData),{},{brut:[].concat(Object(m.a)(e.repCreatorData.brut),[{ferme:1,level:1,rco:1,rep:t.value.rep,salle:t.value.salle}])})})||e;case"ADD_RCO":return Object(f.a)(Object(f.a)({},e),{},{repCreatorData:Object(f.a)(Object(f.a)({},e.repCreatorData),{},{brut:[].concat(Object(m.a)(e.repCreatorData.brut),[{ferme:1,level:1,rco:t.value.rco,rep:t.value.rep,salle:t.value.salle}])})})||e;default:return e}}),window.__REDUX_DEVTOOLS_EXTENSION__&&window.__REDUX_DEVTOOLS_EXTENSION__()),v=a(21),E=a(69),g=a.n(E),y=a(13),O=a(70),N=a(44),j=a(34);var S=Object(y.h)(Object(p.b)((function(e){return{formValue:e.formValue,getFetch:e.getFetch}}))((function(e){var t=Object(n.useState)(""),a=Object(v.a)(t,2),l=a[0],o=a[1],c=e.data.title,s=e.data.type,i=e.data.bName,u=e.data.route,p=e.data.textValue,d=function(){switch(s){case"textarea":return r.a.createElement("textarea",{id:"msg",type:"text",className:"cardArea",name:"tdp_list",rows:"6",placeholder:"Coller votre liste de TDP ici...",value:l,onChange:function(e){return m(e)}});case"text":return r.a.createElement("div",null,r.a.createElement("div",{style:{padding:"10px",fontSize:"15px",textAlign:"justify"}},p));default:return null}},m=function(e){o(e.target.value)};return r.a.createElement("div",{className:"MyCard"},r.a.createElement("div",{className:"Bando-Titre"},r.a.createElement("p",null,c)),r.a.createElement(d,{textValue:p}),r.a.createElement("div",{className:"Bando-Valider"},r.a.createElement("button",{className:"btn btn-sm btn-outline-dark",type:"button",onClick:function(){return function(t){"Go=>"===t&&e.dispatch({type:"RESET_SESSION"}),e.history.push(u)}(i)}},i)))}))),T=a(16);function x(e){var t;try{t=window[e];var a="__storage_test__";return t.setItem(a,a),t.removeItem(a),!0}catch(n){return!1}}var k=function(e){Object(i.a)(a,e);var t=Object(u.a)(a);function a(){var e;Object(c.a)(this,a);for(var n=arguments.length,l=new Array(n),o=0;o<n;o++)l[o]=arguments[o];return(e=t.call.apply(t,[this].concat(l))).getRep=function(e){var t=[];return e.forEach((function(e){return-1===t.findIndex((function(t){return t===e.rep}))?t.push(e.rep):null})),t},e.searchList=function(){if(!x("localStorage"))return null;var t=localStorage.getItem("sessionStockage");if(!t)return null;var a=JSON.parse(t);if(!("data"in a))return null;var n=new Date;return 0!==a.date.localeCompare(n.toDateString())?(delete a.data,delete a.date,localStorage.setItem("sessionStockage",JSON.stringify(a)),null):e.getRep(a.data).map((function(t,a){return r.a.createElement(T.a,{key:a,variant:"primary",size:"sm",block:!0,onClick:function(){return e.handleClick(t)}},t)}))},e.handleClick=function(t){var a=localStorage.getItem("sessionStockage"),n=JSON.parse(a).data,r=[];n.forEach((function(e){e.rep===t&&r.push(e)})),e.props.callback(r)},e}return Object(s.a)(a,[{key:"render",value:function(){return r.a.createElement(r.a.Fragment,null,r.a.createElement(this.searchList,null))}}]),a}(r.a.Component),C=function e(t){Object(c.a)(this,e),this.status=t.status,this.found=t.found,this.cd=t.cd,this.rep=t.rep,this.ferme=t.ferme,this.level=t.level,this.option=t.option,this.rco=t.rco,this.regletteNbr=t.regletteNbr,this.regletteType=t.regletteType,this.salle=t.salle,this.plot=t.plot,this._id=t._id},_=function e(t,a){Object(c.a)(this,e);var n=[];a.forEach((function(e){return e.level===t?n.push(e):null})),this.number=t,this.tdps=n.map((function(e){return new C(e)}))},I=function e(t,a,n){Object(c.a)(this,e);var r=[];a.forEach((function(e){return e.ferme===t?r.push(e):null})),this.number=t,this.index=n,this.level=function(e){var t=[];return e.forEach((function(e){return-1===t.findIndex((function(t){return t===e.level}))?t.push(e.level):null})),t.map((function(t){return new _(t,e)})).sort((function(e,t){return e.number-t.number}))}(r)},R=function(){function e(t,a){Object(c.a)(this,e);var n=[];a.forEach((function(e){return e.rco===t?n.push(e):null})),this.number=t,this.ferme=function(e){var t=[];return e.forEach((function(e){return-1===t.findIndex((function(t){return t===e.ferme}))?t.push(e.ferme):null})),t.map((function(t,a){return new I(t,e,a)}))}(n)}return Object(s.a)(e,[{key:"addFerme",value:function(){}}]),e}(),w=function e(t,a){Object(c.a)(this,e);var n=[];a.forEach((function(e){return e.salle===t?n.push(e):null})),this.number=t,this.rco=function(e){var t=[];return e.forEach((function(e){return-1===t.findIndex((function(t){return t===e.rco}))?t.push(e.rco):null})),t.map((function(t){return new R(t,e)}))}(n)},D=function e(t,a){Object(c.a)(this,e);var n=[];a.forEach((function(e){return e.rep===t?n.push(e):null})),this.name=t,this.salle=function(e){var t=[];return e.forEach((function(e){return-1===t.findIndex((function(t){return t===e.salle}))?t.push(e.salle):null})),t.map((function(t){return new w(t,e)}))}(n)},A=a(27),L=a.n(A),P=a(30);function F(e,t,a){return B.apply(this,arguments)}function B(){return(B=Object(P.a)(L.a.mark((function e(t,a,n){var r,l,o,c,s=arguments;return L.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=s.length>3&&void 0!==s[3]?s[3]:null,0!==n.length){e.next=5;break}return e.abrupt("return",r());case 5:return l=JSON.stringify(n),e.next=8,fetch("https://api.jaffleman.tech/tdp/".concat(t),{method:a,mode:"cors",body:l,headers:{"Content-Type":"application/json"}}).catch((function(e){return alert("probleme"),{err:e}}));case 8:if(!(o=e.sent).ok){e.next=17;break}return e.next=12,o.json();case 12:return c=e.sent,null!==r&&r(),e.abrupt("return",{data:c});case 17:if(!o.err){e.next=19;break}return e.abrupt("return",{err:o.err});case 19:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var U=function e(t,a,n){var r=this;Object(c.a)(this,e),F("search","POST",function(e){var t=Object(m.a)(e),a=[];if(x("localStorage")){var n=localStorage.getItem("sessionStockage");if(null!=n){var r=JSON.parse(n);if(r.data){for(var l=function(){var e=t.shift();-1===r.data.findIndex((function(t){return t.tdpId===e.rep+e.regletteType+e.regletteNbr}))&&a.push(e)};t.length>0;)l();return console.log(a),a}return console.log(t),t}return console.log(t),t}return console.log(t),t}(t),(function(){return{data:[]}})).then((function(e){if(console.log(e),"data"in e){var l=function(e){console.log(e);var t=[];return e.forEach((function(e){"string"===typeof e.plot?t.push(Object(f.a)({},e)):e.plot.forEach((function(a){return t.push(Object(f.a)(Object(f.a)({},e),{},{plot:a}))}))})),t}(function(e,t){for(var a=function(){if(x("localStorage")){var e=JSON.parse(localStorage.getItem("sessionStockage"));return e&&"data"in e?{avalable:!0,data:Object(m.a)(e.data)}:{avalable:!1}}return{avalable:!1}}(),n=[],r=function(){var r=e.shift(),l=function(e){return e.tdpId===r.rep+r.regletteType+r.regletteNbr},o=t.findIndex(l);if(-1===o)if(a.avalable){var c=a.data.findIndex(l);-1===c?n.push(Object(f.a)(Object(f.a)({},r),{},{found:!1})):n.push(Object(f.a)(Object(f.a)({},a.data[c]),{},{plot:r.plot,found:!0,fetched:!1}))}else n.push(Object(f.a)(Object(f.a)({},r),{},{found:!1}));else n.push(Object(f.a)(Object(f.a)({},t[o]),{},{plot:r.plot,found:!0,fetched:!0}))};e.length>0;)r();return n}(t,e.data));!function(e){var t=e.filter((function(e){return e.fetched})).map((function(e){return Object(f.a)(Object(f.a)({},e),{},{fetched:!1})}));if(x("localStorage")){var a=localStorage.getItem("sessionStockage"),n=new Date;if(a){var r=JSON.parse(a);if(console.log(r),"data"in r){var l=[].concat(Object(m.a)(r.data),Object(m.a)(t));console.log(l),localStorage.setItem("sessionStockage",JSON.stringify(Object(f.a)(Object(f.a)({},r),{},{data:[].concat(Object(m.a)(r.data),Object(m.a)(t)),date:n.toDateString()})))}else localStorage.setItem("sessionStockage",JSON.stringify(Object(f.a)(Object(f.a)({},r),{},{data:t,date:n.toDateString()})))}else localStorage.setItem("sessionStockage",JSON.stringify({data:t,date:n.toDateString()}))}}(l),r.rep=function(e){var t=[];e.forEach((function(e){return-1===t.findIndex((function(t){return t===e.rep}))?t.push(e.rep):null}));var n=t.map((function(t){return new D(t,e)}));return a(n)}(l)}else e.err&&n()}))};var K=function e(t){Object(c.a)(this,e);var a=t.split(" ");this.rep=a[0].slice(0,5).toLowerCase(),this.cd=parseInt(a[0].slice(3,5)),this.regletteType=9===a[1].length?(a[1].slice(0,1)+"/"+a[1].slice(1,4)).toUpperCase():a[1].slice(0,5).toUpperCase(),this.regletteNbr=a[1].slice(-5,-3).toUpperCase(),this.plot=[a[1].slice(-3)]};function M(e){return function(e){for(var t=[],a=function(){var a=e.shift(),n=t.findIndex((function(e){var t=e.rep,n=e.regletteType,r=e.regletteNbr;return t===a.rep&&n===a.regletteType&&r===a.regletteNbr}));-1===n?t.push(a):t[n].plot.push(a.plot[0])};e.length>0;)a();return t}(function(e){for(var t=/([a-zA-Z]){3}([0-9]){2}((-[0-9])|(-([0-9]{2}))|) ((L\/INX)|(A\/TEL)|(R\/DEG)|(T\/LIF)|(linx)|(atel)|(rdeg)|tlif)(\w){2}([0-9]){3}|(([a-zA-Z]){3}([0-9]){2}((-[0-9])|(-([0-9]{2}))|) ((L\/INX)|(A\/TEL)|(R\/DEG)|(T\/LIF)|(linx)|(atel)|(rdeg)|tlif)(\w){2})/gim,a=[],n=[];null!==(a=t.exec(e));)n.includes(a[0])||n.push(a[0]);return n}(e).map((function(e){return new K(e)})))}var H=function e(t){Object(c.a)(this,e),this.time=new Date,this.donneesExtraites=M(t),this.nombreDeTestDemande=this.donneesExtraites.length,this.valide=this.nombreDeTestDemande>0,this.jsonData=[this.time,this.donneesExtraites]};function V(){return(V=Object(P.a)(L.a.mark((function e(t){return L.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:navigator.clipboard&&navigator.clipboard.readText().then((function(e){return t(e)}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var G=function(e,t){t.dispatch({type:"UPDATE_LOADER",value:e})},J=Object(p.b)((function(e){return{mustLoad:e.mustLoad}}))((function(e){var t=x("localStorage"),a=!(t&&"credentials"in navigator),l=Object(n.useRef)(),o=Object(y.g)(),c=Object(n.useState)(""),s=Object(v.a)(c,2),i=s[0],u=s[1],p=Object(n.useState)((function(){if(!t)return!1;var e=JSON.parse(localStorage.getItem("sessionStockage"));return!!e&&("autopast"in e&&e.autopast)})),d=Object(v.a)(p,2),h=d[0],b=d[1],E=function(){if(h){!function(e){V.apply(this,arguments)}((function(e){e.length>0&&(l.current.value=e,u(e))}))}},T=function(t){new U(Object(m.a)(t),(function(e){return o.push("/Shower",e)}),(function(){G(!1,e)}))};return r.a.createElement(O.a,null,r.a.createElement("div",{className:"main"},r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"col-lg",style:{marginTop:"20px"}},r.a.createElement("div",{className:"MyCard"},r.a.createElement("div",{className:"Bando-Titre"},r.a.createElement("p",null,"TDP Search")),r.a.createElement("form",null,r.a.createElement("textarea",{ref:l,id:"msg",type:"text",className:"cardArea",name:"tdp_list",rows:"6",placeholder:"Coller votre liste de TDP ici ou taper la position recherch\xe9e: ex: cho94 linx19127...",value:i,onClick:function(){return E()},onChange:function(e){return function(e){return u(e.target.value)}(e)}})),r.a.createElement("div",{className:"Bando-Valider"},r.a.createElement(O.a,null,r.a.createElement(N.a,null,r.a.createElement(j.a,{className:"align-items-center"},r.a.createElement("div",{style:{marginTop:"10px"}},r.a.createElement(g.a,{onChange:function(e){return function(e){if(b(e),t){var a=JSON.parse(localStorage.getItem("sessionStockage"));localStorage.setItem("sessionStockage",JSON.stringify(Object(f.a)(Object(f.a)({},a),{},{autopast:e}))),e||u("")}}(e)},checked:h,disabled:a}))),r.a.createElement(j.a,{xs:6},r.a.createElement("button",{className:"btn btn-sm btn-outline-dark",type:"button",onClick:function(){return function(){G(!0,e);var t=new H(i);t.valide?T(t.donneesExtraites):(u(""),alert("Aucun TDP trouv\xe9..."),G(!1,e))}()}},"Lancer la recherche")),r.a.createElement(j.a,null)))))),r.a.createElement("div",{className:"col-lg",style:{marginTop:"20px"}},r.a.createElement("div",{className:"MyCard"},r.a.createElement("div",{className:"Bando-Titre"},r.a.createElement("p",null,"derni\xe8res recherches")),r.a.createElement(k,{callback:T}),r.a.createElement("div",{className:"Bando-Valider"},r.a.createElement("button",{className:"btn btn-sm btn-outline-dark",type:"button",onClick:function(){return function(){if(t){var e=JSON.parse(localStorage.getItem("sessionStockage"));delete e.data,delete e.date,localStorage.setItem("sessionStockage",JSON.stringify(e)),o.go(0)}}()}},"Effacer l'historique")))),r.a.createElement("div",{className:"col-lg",style:{marginTop:"20px"}},r.a.createElement(S,{data:{title:"Cr\xe9ation de r\xe9partiteur:",type:"text",textValue:'Le mode "cr\xe9ation de rep" te permets d\'int\xe9grer ton r\xe9partiteur. Une fois cr\xe9\xe9, il sera accessible par tout les utilisateurs de MapTDP. Il est important de prendre le temps d\'int\xe9grer les r\xe9partiteurs afin de peupler la base de MapTDP et aissi faciliter la recherche des futurs TDP. Si tu souhaites int\xe9grer un r\xe9partiteur cliques sur "GO=>"',bName:"Go=>",route:"/Displayer"}})))))})),W=a(25),z=function(e){Object(i.a)(a,e);var t=Object(u.a)(a);function a(){var e;Object(c.a)(this,a);for(var n=arguments.length,r=new Array(n),l=0;l<n;l++)r[l]=arguments[l];return(e=t.call.apply(t,[this].concat(r))).shouldShortPress=!0,e.moved=!1,e.state={touch:!0},e.startTimeout=function(){e.timeout=setTimeout(e.longPressed,e.props.time)},e.longPressed=function(){e.shouldShortPress=!1,e.props.onLongPress&&!1===e.moved&&e.props.onLongPress()},e.cancelTimeout=function(){clearTimeout(e.timeout)},e.onTouchStart=function(t){e.shouldShortPress=!0,e.moved=!1,e.startTimeout(),"function"===typeof e.props.onTouchStart&&e.props.onTouchStart(t)},e.onTouchEnd=function(t){e.cancelTimeout(),e.props.onPress&&e.shouldShortPress&&!1===e.moved&&e.props.onPress(),"function"===typeof e.props.onTouchEnd&&e.props.onTouchEnd(t)},e.onTouchCancel=function(t){e.cancelTimeout(),"function"===typeof e.props.onTouchCancel&&e.props.onTouchCancel(t)},e.onMove=function(t){e.moved=!0,"function"===typeof e.props.onTouchMove&&e.props.onTouchMove(t)},e}return Object(s.a)(a,[{key:"componentDidMount",value:function(){try{document.createEvent("TouchEvent")}catch(e){this.setState({touch:!1})}}},{key:"componentWillUnmount",value:function(){this.cancelTimeout()}},{key:"render",value:function(){var e=this.props,t=e.children,a=e.disabled;if(!this.state.touch||a)return t;var n={onContextMenu:function(e){return e.preventDefault()},onTouchStart:this.onTouchStart,onTouchEnd:this.onTouchEnd,onTouchMove:this.onMove,onTouchCancel:this.onTouchCancel,style:Object(f.a)(Object(f.a)({},t.props.style),{},{WebkitUserSelect:"none",WebkitTouchCallout:"none"})};return r.a.cloneElement(t,Object(f.a)(Object(f.a)({},t.props),n))}}]),a}(n.Component);z.defaultProps={time:500};var q=z,X=a(71),Q=a.n(X);var $=function(e){Object(i.a)(a,e);var t=Object(u.a)(a);function a(){return Object(c.a)(this,a),t.apply(this,arguments)}return Object(s.a)(a,[{key:"render",value:function(){var e=this.props.data,t=e.rep,a=e.salle,n=e.rco,l=e.ferme,o=e.level,c=e._id,s=function(e){for(var t=0,a=[],n=1;n<17;n++)for(var r=1;r<9;r++)a[t]=["".concat(n,"-").concat(r)],t++;return a[parseInt(e)]}(e.plot);return this.props.ndToShow===c?r.a.createElement("div",null,r.a.createElement("p",{style:{margin:0}},"COORDONNEES: [",r.a.createElement("span",{style:{fontWeight:"bold"}},"".concat(l)),"-",r.a.createElement("span",{style:{fontWeight:"bold"}},"".concat(o)),"][",r.a.createElement("span",{style:{fontWeight:"bold"}},s),"]"),r.a.createElement("p",{style:{margin:0}},"[",r.a.createElement("span",{style:{fontWeight:"bold"}},"".concat(t)),"]  Salle:[",r.a.createElement("span",{style:{fontWeight:"bold"}},"".concat(a)),"]  rco:[",r.a.createElement("span",{style:{fontWeight:"bold"}},"".concat(n)),"]")):null}}]),a}(r.a.Component),Z=Object(p.b)((function(e){return{ndToShow:e.ndToShow}}))($),Y=function(e){Object(i.a)(a,e);var t=Object(u.a)(a);function a(){var e;Object(c.a)(this,a);for(var n=arguments.length,r=new Array(n),l=0;l<n;l++)r[l]=arguments[l];return(e=t.call.apply(t,[this].concat(r))).state={pressed:[]},e.addToPressed=function(t){t._id!==e.props.ndToShow&&t.found||(e.props.dispatch({type:"SHOW_MODAL",value:t}),Q()((function(){return window.$("#laModal").modal()})))},e.removeFromPressed=function(t){return e.setState({pressed:e.state.pressed.filter((function(e){return e!==t}))})},e}return Object(s.a)(a,[{key:"_toggleView",value:function(e){var t={type:"TOGGLE_FAVORITE",value:e};this.props.dispatch(t)}},{key:"styler",value:function(e){return this.props.ndToShow===e?"Letes2":-1===this.props.alreadyShow.indexOf(e)?"Letes":"Letes3"}},{key:"render",value:function(){var e=this,t=this.props.tdp,a=t._id,n=t.regletteType,l=t.regletteNbr,o=t.option,c=t.plot,s=t.found,i={badgeLabel:"",badgeColor:""};return"I"===o?(i.badgeColor="badge-warning",i.badgeLabel="Inver"):"TNI"===o?(i.badgeColor="badge-danger",i.badgeLabel="NoIso"):(i.badgeColor="badge-success",i.badgeLabel="Ok!"),s?r.a.createElement("div",null,r.a.createElement(q,{key:a,time:500,onLongPress:function(){return e.addToPressed(e.props.tdp)},onPress:function(){return e.removeFromPressed(a)}},r.a.createElement("div",{className:"tdp ".concat(this.styler(a)),onClick:function(){e._toggleView(a)}},r.a.createElement("div",{style:{display:"flex"}},r.a.createElement("p",{style:{margin:"0"}}),r.a.createElement("p",{style:{flex:10},className:"tdp2"}," ",n+l,"-",c),r.a.createElement("span",{className:"badge badge-pill ".concat(i.badgeColor)},i.badgeLabel)),r.a.createElement(Z,{data:this.props.tdp})))):void 0===s?null:r.a.createElement("div",null,r.a.createElement(q,{key:a,time:500,onLongPress:function(){return e.addToPressed(e.props.tdp)},onPress:function(){return e.removeFromPressed(a)}},r.a.createElement("div",{className:"tdp Letes3",onClick:function(){}},r.a.createElement("div",{style:{display:"flex"}},r.a.createElement("p",{style:{margin:"0"}},"what!"),r.a.createElement("p",{style:{flex:10},className:"tdp2"}," ",n+l,"-",c)))))}}]),a}(r.a.Component),ee=Object(p.b)((function(e){return{ndToShow:e.ndToShow,alreadyShow:e.alreadyShow}}))(Y),te=function(e){Object(i.a)(a,e);var t=Object(u.a)(a);function a(){return Object(c.a)(this,a),t.apply(this,arguments)}return Object(s.a)(a,[{key:"render",value:function(){var e=this.props.level;return r.a.createElement("div",{className:"main",style:{color:"red"}},e.tdps.map((function(e,t){return r.a.createElement(ee,{key:t,tdp:e})})))}}]),a}(r.a.Component),ae=function(e){Object(i.a)(a,e);var t=Object(u.a)(a);function a(){return Object(c.a)(this,a),t.apply(this,arguments)}return Object(s.a)(a,[{key:"render",value:function(){var e=this.props.ferme;return r.a.createElement("div",{className:"main",style:{color:"blue"}},e.level.map((function(e,t){return r.a.createElement(te,{key:t,level:e})})))}}]),a}(r.a.Component),ne=function(e){Object(i.a)(a,e);var t=Object(u.a)(a);function a(){return Object(c.a)(this,a),t.apply(this,arguments)}return Object(s.a)(a,[{key:"render",value:function(){var e=this.props.rco;return r.a.createElement("div",{className:"main",style:{color:"lightgreen"}},r.a.createElement("h5",{className:"tdpHead rco"},"Rco: ",void 0===e.number?"?":e.number),e.ferme.map((function(e,t){return r.a.createElement(ae,{key:t,ferme:e})})))}}]),a}(r.a.Component),re=function(e){Object(i.a)(a,e);var t=Object(u.a)(a);function a(){return Object(c.a)(this,a),t.apply(this,arguments)}return Object(s.a)(a,[{key:"render",value:function(){var e=this.props.salle;return r.a.createElement("div",{className:"main",style:{color:"yellow"}},r.a.createElement("h4",{className:"tdpHead salle"},"Salle: ",void 0===e.number?"?":e.number),e.rco.map((function(e,t){return r.a.createElement(ne,{key:t,rco:e})})))}}]),a}(r.a.Component),le=function(e){Object(i.a)(a,e);var t=Object(u.a)(a);function a(){return Object(c.a)(this,a),t.apply(this,arguments)}return Object(s.a)(a,[{key:"render",value:function(){var e=this.props.rep;return r.a.createElement("div",{className:"main",style:{color:"white"}},r.a.createElement("h3",{className:"tdpHead rep"},"REPARTITEUR DE ",e.name),e.salle.map((function(e,t){return r.a.createElement(re,{key:t,salle:e})})))}}]),a}(r.a.Component);var oe=Object(p.b)((function(e){return{modalData:e.modalData}}))((function(e){var t=e.modalData,a=t._id,l=t.rep,o=t.cd,c=t.regletteNbr,s=t.regletteType,i=Object(n.useState)(1),u=Object(v.a)(i,2),p=u[0],d=u[1],m=Object(n.useState)(1),f=Object(v.a)(m,2),h=f[0],b=f[1],E=Object(n.useState)(1),g=Object(v.a)(E,2),y=g[0],O=g[1],N=Object(n.useState)(1),j=Object(v.a)(N,2),S=j[0],T=j[1],x=Object(n.useState)("x"),k=Object(v.a)(x,2),C=k[0],_=k[1];function I(){e.dispatch({type:"SHOW_MODAL",value:{}})}return Object(n.useEffect)((function(){}),[]),r.a.createElement("div",{className:"modal fade",id:"laModal",tabIndex:"-1","aria-labelledby":"exampleModalLabel","aria-hidden":"true"},r.a.createElement("div",{className:"modal-dialog"},r.a.createElement("div",{className:"modal-content"},r.a.createElement("div",{className:"modal-header"},r.a.createElement("h5",{className:"modal-title",id:"exampleModalLabel"},"Modifier..."),r.a.createElement("button",{type:"button",className:"close","data-dismiss":"modal","aria-label":"Close"},r.a.createElement("span",{"aria-hidden":"true"},"\xd7"))),r.a.createElement("div",{className:"modal-body"},r.a.createElement("p",null,"Merci de renseigner les infos manquantes pour cette position:"),r.a.createElement("form",null,r.a.createElement("p",null,"REPARTITEUR: ",l),r.a.createElement("p",null,"Reglette: ",s+c),r.a.createElement("p",null,"Salle:",r.a.createElement("select",{onChange:function(e){!function(e){d(e.target.value)}(e)}},r.a.createElement("option",{defaultValue:"1"},"1"),r.a.createElement("option",{value:"2"},"2"),r.a.createElement("option",{value:"3"},"3"))),r.a.createElement("p",null,"rco:",r.a.createElement("select",{onChange:function(e){!function(e){b(e.target.value)}(e)}},r.a.createElement("option",{defaultValue:"1"},"1"),r.a.createElement("option",{value:"2"},"2"),r.a.createElement("option",{value:"3"},"3"))),r.a.createElement("p",null,"Ferme:",r.a.createElement("input",{type:"number",min:"1",max:"50",onChange:function(e){!function(e){O(e.target.value)}(e)}})),r.a.createElement("p",null,"Niveau:",r.a.createElement("select",{onChange:function(e){!function(e){T(e.target.value)}(e)}},r.a.createElement("option",{defaultValue:"1"},"1"),r.a.createElement("option",{value:"2"},"2"),r.a.createElement("option",{value:"3"},"3"),r.a.createElement("option",{value:"4"},"4"),r.a.createElement("option",{value:"5"},"5"),r.a.createElement("option",{value:"6"},"6"),r.a.createElement("option",{value:"7"},"7"),r.a.createElement("option",{value:"8"},"8"))),r.a.createElement("p",null,"Option:",r.a.createElement("select",{onChange:function(e){!function(e){_(e.target.value)}(e)}},r.a.createElement("option",{defaultValue:""},"..."),r.a.createElement("option",{value:"I"},"Invers\xe9e"),r.a.createElement("option",{value:"TNI"},"Non isolable"))))),r.a.createElement("div",{className:"modal-footer"},r.a.createElement("button",{type:"button",className:"btn btn-secondary","data-dismiss":"modal",onClick:function(){return I()}},"Close"),r.a.createElement("button",{type:"button",className:"btn btn-primary",onClick:function(){F("update","PUT",[{_id:a,regletteType:s,regletteNbr:c,cd:o,rep:l,salle:p,rco:h,ferme:y,level:S,opt:C}],I())}},"Save changes")))))})),ce=function(e){Object(i.a)(a,e);var t=Object(u.a)(a);function a(){return Object(c.a)(this,a),t.apply(this,arguments)}return Object(s.a)(a,[{key:"componentDidMount",value:function(){G(!1,this.props)}},{key:"render",value:function(){var e=this.props.location.state;return r.a.createElement("div",null,r.a.createElement(oe,null),r.a.createElement("div",{className:"main"},e.map((function(e,t){return r.a.createElement(le,{key:t,rep:e})}))))}}]),a}(r.a.Component),se=Object(y.h)(Object(p.b)()(ce)),ie=Object(p.b)((function(e){return{mustLoad:e.mustLoad}}))((function(e){return e.mustLoad?r.a.createElement("div",{className:"spinner-border ml-auto",role:"status","aria-hidden":"true"}):null}));var ue=function(){return r.a.createElement("div",{className:"fixed-top"},r.a.createElement("div",{className:"title",style:{display:"flex"}},r.a.createElement("div",{style:{flex:1}}),r.a.createElement("div",{style:{flex:5}},r.a.createElement("h2",{style:{fontWeight:"bold"}},"MapTDP")),r.a.createElement("div",{style:{flex:1}},r.a.createElement(ie,null))))},pe=function(e){Object(i.a)(a,e);var t=Object(u.a)(a);function a(e){var n;return Object(c.a)(this,a),(n=t.call(this,e)).Add=function(){if(n.state.value<4){var e=n.state.value+1;n.setState({value:e})}},n.Remove=function(){if(n.state.value>1){var e=n.state.value-1;n.setState({value:e})}},n.state={value:1},n}return Object(s.a)(a,[{key:"render",value:function(){return r.a.createElement("div",{className:"btn-toolbar ",role:"toolbar","aria-label":"Toolbar with button groups"},r.a.createElement("div",{className:"input-group"},r.a.createElement("div",{className:"input-group-prepend"},r.a.createElement("div",{className:"input-group-text",id:"btnGroupAddon"},"Nombre de ",this.props.name)),r.a.createElement("input",{type:"text",className:"form-control",style:{maxWidth:"55px"},value:this.state.value,"aria-describedby":"btnGroupAddon",readOnly:!0})),r.a.createElement("div",{className:"btn-group btn-group-sm mr-2",role:"group","aria-label":"First group"},r.a.createElement("button",{type:"button",className:"btn btn-secondary",onClick:this.Remove},"-"),r.a.createElement("button",{type:"button",className:"btn btn-secondary",onClick:this.Add},"+")),r.a.createElement("div",{className:"",style:{width:"-webkit-fill-available",paddingTop:"5px"}},this.props.call(this.state.value,this.state.salleNum)))}}]),a}(r.a.Component),de=function(e){Object(i.a)(a,e);var t=Object(u.a)(a);function a(e){var n;return Object(c.a)(this,a),(n=t.call(this,e)).nbFerme_handleChange=function(e){var t=n.props.repStructure.tab,a=n.props.number,r=parseInt(e.target.value);if(r<99&&r>0){if(r!==t[n.props.parentKey][a].length){if(r>t[n.props.parentKey][a].length)for(var l=r-n.state.fermeNumber,o=0;o<l;o++)t[n.props.parentKey][a].push([["x"],["x"],["x"],["x"],["x"],["x"],["x"],["x"]]);else for(var c=n.state.fermeNumber-r,s=0;s<c;s++)t[n.props.parentKey][a].pop();var i={type:"SET_REP_STRUCTURE",value:t};n.props.dispatch(i)}n.setState({fermeNumber:r})}},n.state={fermeNumber:1},n}return Object(s.a)(a,[{key:"render",value:function(){return r.a.createElement("div",{className:"input-group d-flex  "},r.a.createElement("div",{className:"input-group-prepend"},r.a.createElement("div",{className:"input-group-text",id:"btnGroupAddon"},"rco: "+(this.props.number+1),": Nombre de colonne :")),r.a.createElement("input",{type:"number",className:"form-control",style:{},defaultValue:this.fermeNumber,onChange:this.nbFerme_handleChange,"aria-describedby":"btnGroupAddon"}))}}]),a}(r.a.Component),me=Object(p.b)((function(e){return{repStructure:e.repStructure}}))(de),fe=function(e){Object(i.a)(a,e);var t=Object(u.a)(a);function a(){return Object(c.a)(this,a),t.apply(this,arguments)}return Object(s.a)(a,[{key:"render",value:function(){for(var e=this,t=[],a=this.props.repStructure.tab,n=0;n<this.props.number;n++)t.push("x");if(t.length!==a[this.props.parentKey].length){t.length>a[this.props.parentKey].length?a[this.props.parentKey].push([[["x"],["x"],["x"],["x"],["x"],["x"],["x"],["x"]]]):a[this.props.parentKey].pop();var l={type:"SET_REP_STRUCTURE",value:a};this.props.dispatch(l)}return t.map((function(t,a){return r.a.createElement(me,{parentKey:e.props.parentKey,key:a,number:a})}))}}]),a}(r.a.Component),he=Object(p.b)((function(e){return{repStructure:e.repStructure}}))(fe),be=function(e){Object(i.a)(a,e);var t=Object(u.a)(a);function a(e){var n;return Object(c.a)(this,a),(n=t.call(this,e)).CallNext=function(e){return r.a.createElement(he,{parentKey:n.props.salleNum,number:e})},n.state={rcoNumber:0},n}return Object(s.a)(a,[{key:"render",value:function(){return r.a.createElement(pe,{name:"rco",call:this.CallNext})}}]),a}(r.a.Component),ve=function(e){Object(i.a)(a,e);var t=Object(u.a)(a);function a(){return Object(c.a)(this,a),t.apply(this,arguments)}return Object(s.a)(a,[{key:"render",value:function(){for(var e=[],t=this.props.repStructure.tab,a=0;a<this.props.number;a++)e.push("x");return e.length!==t.length&&(e.length>t.length?t.push([[[["x"],["x"],["x"],["x"],["x"],["x"],["x"],["x"]]]]):t.pop(),this.props.dispatch({type:"MUST_SET_REP_STRUCTURE",value:t})),e.map((function(e,t){return r.a.createElement("div",{key:t,className:"Creator"},r.a.createElement("h5",null,"Salle: ",t+1),r.a.createElement(be,{key:t,salleNum:t}))}))}}]),a}(r.a.Component),Ee=Object(p.b)((function(e){return{repStructure:e.repStructure}}))(ve),ge=function(){var e=Object(P.a)(L.a.mark((function e(t,a){return L.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(/^([a-z]){3}([0-9]){2}$/.test(t)){e.next=3;break}return e.abrupt("return",alert("".concat(t,": Le nom du rep est incorrect")));case 3:F("searchRep","POST",[{rep:t}]).then((function(e){return a(e,t)}));case 4:case"end":return e.stop()}}),e)})));return function(t,a){return e.apply(this,arguments)}}(),ye=function(e){Object(i.a)(a,e);var t=Object(u.a)(a);function a(e){var n;return Object(c.a)(this,a),(n=t.call(this,e)).repName_handleChange=function(e){n.setState({repName:e.target.value.toLowerCase()})},n.CallNext=function(e){return r.a.createElement(Ee,{key:e,number:e})},n.handle_goBack=function(){n.props.history.goBack()},n.handle_valideClick=function(){if(window.confirm("Tout est ok ?? Tu confirmes la cr\xe9ation de: [".concat(n.state.repName,"] \n"))){n.props.dispatch({type:"UPDATE_LOADER",value:!0});ge(n.state.repName,(function(e){n.props.dispatch({type:"UPDATE_LOADER",value:!1}),0===e.length?n.setState({redirect:!0}):alert("Le nom du rep n'est pas valide ou il existe deja...")}))}},n.Load=function(){return n.state.load?r.a.createElement(ie,null):null},n.state={repName:"",load:!1,redirect:!1},n}return Object(s.a)(a,[{key:"componentWillUnmount",value:function(){this.props.dispatch({type:"SET_REP_STRUCTURE",value:[[[[["x"],["x"],["x"],["x"],["x"],["x"],["x"],["x"]]]]]})}},{key:"componentDidMount",value:function(){}},{key:"render",value:function(){var e=this;return this.state.redirect?r.a.createElement(y.a,{to:{pathname:"/Peupler",state:{repartiteur:this.state.repName,structure:this.props.repStructure}}}):r.a.createElement("div",null,r.a.createElement("div",{className:"d-flex justify-content-between",style:{marginBottom:"20px"}},r.a.createElement("button",{type:"button",className:"btn btn-secondary",style:{float:"right",marginBottom:"5px"},onClick:this.handle_goBack},"<< Retour"),r.a.createElement("button",{type:"button",className:"btn btn-success",style:{float:"right",marginBottom:"5px"},onClick:this.handle_valideClick},"Creer le rep")),r.a.createElement("div",{className:"input-group ",style:{width:"250px"}},r.a.createElement("div",{className:"input-group-prepend"},r.a.createElement("span",{className:"input-group-text",id:"basic-addon3"},"R\xe9partiteur:")),r.a.createElement("input",{type:"text",className:"form-control",id:"rep-name",maxLength:"5",placeholder:"ex:cho94","aria-describedby":"basic-addon3",value:this.state.repName,onChange:function(t){return e.repName_handleChange(t)}})),r.a.createElement("div",null,r.a.createElement(pe,{name:"Salle",call:this.CallNext})),r.a.createElement(this.Load,null))}}]),a}(r.a.Component),Oe=Object(y.h)(Object(p.b)((function(e){return{repStructure:e.repStructure}}))(ye)),Ne=a(19),je=a(75),Se=a(74),Te=function(e){Object(i.a)(a,e);var t=Object(u.a)(a);function a(){return Object(c.a)(this,a),t.apply(this,arguments)}return Object(s.a)(a,[{key:"render",value:function(){var e=this.props,t=e.number,a=e.back,n=e.next,l=e.fermes,o=e.handleClick,c=e.id,s=this.props.number===this.props.total?" + ":">";return r.a.createElement("div",{style:{marginTop:"5px"}},r.a.createElement(O.a,{fluid:!0},r.a.createElement(N.a,{style:{padding:"0px",marginLeft:"0px",marginRight:"0px"}},r.a.createElement(T.a,{size:"sm",onClick:a},"<"),r.a.createElement(j.a,{xs:10,style:{padding:"0px",marginLeft:"0px",marginRight:"0px"}},l.map((function(e){var a=e.number>9?e.number:"0".concat(e.number),n=t===e.number?{backgroundColor:"#e46b50",color:"black"}:{backgroundColor:"white",color:"black"};return r.a.createElement(T.a,{size:"sm",key:"".concat(c,"ferme").concat(e.number),className:"buttonFerme ".concat(e.number),style:n,type:"button",onClick:function(){return o(e.index)}},a)}))),r.a.createElement(T.a,{size:"sm",onClick:n},s))))}}]),a}(r.a.Component),xe=function(e){Object(i.a)(a,e);var t=Object(u.a)(a);function a(e){var n;return Object(c.a)(this,a),(n=t.call(this,e)).HeadHandleChange=function(e){var t=n.props.session.modifRegType([n.props.val.tdps[0]._id],e.target.value);n.props.dispatch({type:"SET_SESSION_DATA",value:t})},n.EndHandleChange=function(e){var t=n.props.session.modifOption([n.props.val.tdps[0]._id],e.target.value);n.props.dispatch({type:"SET_SESSION_DATA",value:t})},n.state={nd:n.props.nd,val:n.props.val},n}return Object(s.a)(a,[{key:"BodyHandleChange",value:function(e){var t=this.props.session.modifRegNbr([this.props.val.tdps[0]._id],e.target.value);this.props.dispatch({type:"SET_SESSION_DATA",value:t}),2===e.target.value.length&&this.props.nextFocus(parseInt(this.props.nd))}},{key:"deleteHandleClick",value:function(){var e=this.props.session.modifRegType([this.props.val.tdps[0]._id],"x").modifRegNbr([this.props.val.tdps[0]._id],"").modifOption([this.props.val.tdps[0]._id],"");this.props.dispatch({type:"SET_SESSION_DATA",value:e})}},{key:"render",value:function(){return r.a.createElement("div",{className:"RegletteConstructor"},r.a.createElement("div",null,r.a.createElement("h5",null,r.a.createElement("span",{className:"badge badge-secondary"},"Niveau ",this.props.nd))),r.a.createElement("div",{style:{marginLeft:"15px"}},r.a.createElement("select",{className:"custom-select custom-select-sm",value:this.props.val.tdps[0].regletteType,id:"select1:".concat(this.props.val.tdps[0]._id).concat(this.props.keyOrigin),style:{textAlign:"right"},onChange:this.HeadHandleChange.bind(this)},r.a.createElement("option",{value:"x",defaultValue:!0},"-----"),r.a.createElement("option",{value:"L/INX"},"L/INX"),r.a.createElement("option",{value:"R/DEG"},"R/DEG"),r.a.createElement("option",{value:"T/LIF"},"T/LIF"),r.a.createElement("option",{value:"A/TEL"},"A/TEL"))),r.a.createElement("input",{id:"input:".concat(this.props.val.tdps[0]._id).concat(this.props.keyOrigin),ref:this.props.laRef,type:"text",maxLength:"2",style:{width:"46px"},className:"form-control form-control-sm",value:this.props.val.tdps[0].regletteNbr,onChange:this.BodyHandleChange.bind(this),onBlur:function(){}}),r.a.createElement("div",{style:{marginLeft:"10px",width:"70px"}},r.a.createElement("select",{className:"custom-select custom-select-sm",value:null===this.props.val.tdps[0].option?"...":this.props.val.tdps[0].option,id:"".concat(this.props.val.tdps[0]._id,"option").concat(this.props.keyOrigin),onChange:this.EndHandleChange.bind(this),style:{}},r.a.createElement("option",{value:"null"},"..."),r.a.createElement("option",{value:"I"},"Invers\xe9e"),r.a.createElement("option",{value:"TNI"},"T\xeate Non Isolable"))),r.a.createElement(T.a,{variant:"danger",style:{marginLeft:"15px"},size:"sm",onClick:this.deleteHandleClick.bind(this)},"x"))}}]),a}(r.a.Component),ke=Object(p.b)((function(e){return{session:e.session}}))(xe),Ce=function(e){Object(i.a)(a,e);var t=Object(u.a)(a);function a(e){var n;return Object(c.a)(this,a),(n=t.call(this,e)).HeadHandleChange=function(e){var t=n.props.session.modifRegType(n.props.tabId,e.target.value);n.props.dispatch({type:"SET_SESSION_DATA",value:t}),n.headTrameRef.current.value="x"},n.EndHandleChange=function(e){var t=n.props.session.modifOption(n.props.tabId,e.target.value);n.props.dispatch({type:"SET_SESSION_DATA",value:t}),n.endTrameRef.current.value="x"},n.state={repName:"",theSession:void 0},n.headTrameRef=r.a.createRef(),n.endTrameRef=r.a.createRef(),n}return Object(s.a)(a,[{key:"deleteHandleClick",value:function(){var e=this.props.session.modifRegType(this.props.tabId,"x").modifRegNbr(this.props.tabId,"").modifOption(this.props.tabId,"");this.props.dispatch({type:"SET_SESSION_DATA",value:e})}},{key:"render",value:function(){return r.a.createElement("div",{className:"RegletteConstructor"},r.a.createElement("div",null,r.a.createElement("h5",null,r.a.createElement("span",{className:"badge badge-secondary"},"Trame"))),r.a.createElement("div",{style:{marginLeft:"40px"}},r.a.createElement("select",{id:"headTrame",ref:this.headTrameRef,className:"custom-select custom-select-sm",style:{textAlign:"right"},onChange:this.HeadHandleChange.bind(this)},r.a.createElement("option",{value:"x",defaultValue:!0}),r.a.createElement("option",{value:"L/INX"},"L/INX"),r.a.createElement("option",{value:"R/DEG"},"R/DEG"),r.a.createElement("option",{value:"T/LIF"},"T/LIF"),r.a.createElement("option",{value:"A/TEL"},"A/TEL"))),"|===|",r.a.createElement("div",{style:{marginLeft:"10px",width:"70px"}},r.a.createElement("select",{id:"endTrame",ref:this.endTrameRef,className:"custom-select custom-select-sm",onChange:this.EndHandleChange.bind(this),style:{}},r.a.createElement("option",{value:"x"}),r.a.createElement("option",{value:"null"},"Aucun"),r.a.createElement("option",{value:"I"},"Invers\xe9e"),r.a.createElement("option",{value:"TNI"},"T\xeate Non Isolable"))),r.a.createElement(T.a,{variant:"danger",style:{marginLeft:"15px"},size:"sm",onClick:this.deleteHandleClick.bind(this)},"x"))}}]),a}(r.a.Component),_e=Object(p.b)((function(e){return{session:e.session}}))(Ce),Ie=function(e){Object(i.a)(a,e);var t=Object(u.a)(a);function a(e){var r;return Object(c.a)(this,a),(r=t.call(this,e)).nextFocus=function(e){8===e?r.props.validRef.current.focus():r.refTab[e].current.focus()},r.refL1=Object(n.createRef)(),r.refL2=Object(n.createRef)(),r.refL3=Object(n.createRef)(),r.refL4=Object(n.createRef)(),r.refL5=Object(n.createRef)(),r.refL6=Object(n.createRef)(),r.refL7=Object(n.createRef)(),r.refL8=Object(n.createRef)(),r.refTab=[r.refL1,r.refL2,r.refL3,r.refL4,r.refL5,r.refL6,r.refL7,r.refL8],r}return Object(s.a)(a,[{key:"reglette",value:function(e){var t=this;return e.map((function(e){return r.a.createElement(ke,{tdpRegNbrChange:t.props.tdpRegNbrChange,nd:e.number,key:e.number,keyOrigin:"level".concat(e.number),val:e,laRef:t.refTab[e.number-1],nextFocus:t.nextFocus})}))}},{key:"render",value:function(){var e=this.props.data.map((function(e){return e.tdps[0]._id}));return r.a.createElement("div",null,r.a.createElement(_e,{tabId:e}),this.reglette(this.props.data))}}]),a}(r.a.Component),Re=function(e){Object(i.a)(a,e);var t=Object(u.a)(a);function a(e){var n;return Object(c.a)(this,a),(n=t.call(this,e)).fermeUp=function(){var e=n.state.increment;if(n.props.data.ferme[e].number<n.props.data.ferme[n.props.data.ferme.length-1].number)n.setState({increment:e+1});else{var t=n.props.session.addFerme(n.props.salleNumb,n.props.rcoNumb,n.props.data.ferme[e].number+1);n.props.dispatch({type:"SET_SESSION_DATA",value:t}),n.setState({increment:e+1})}},n.fermeBack=function(){var e=n.state.increment;n.props.data.ferme[e].number>n.props.data.ferme[0].number&&n.setState({increment:e-1})},n.directFerme=function(e){n.setState({increment:e})},n.state={increment:0,repName:"",repartiteur:"",salle:0,rco:0,ferme:0,structure:[[[[["x"],["x"],["x"],["x"],["x"],["x"],["x"],["x"]]]]],load:!1,loadRepResult:""},n}return Object(s.a)(a,[{key:"render",value:function(){var e=this.props.data.ferme,t=this.state.increment,a="salle"+this.props.salleNumb+"rco"+this.props.rcoNumb;return r.a.createElement(r.a.Fragment,null,r.a.createElement("div",null,r.a.createElement(Te,{number:e[t].number,id:a,fermes:e,next:this.fermeUp,back:this.fermeBack,handleClick:this.directFerme})),r.a.createElement("div",null,r.a.createElement(Ie,{key:e[t].level,data:e[t].level,validRef:this.props.validRef})))}}]),a}(r.a.Component),we=Object(y.h)(Object(p.b)((function(e){return{session:e.session}}))(Re)),De=function(e){Object(i.a)(a,e);var t=Object(u.a)(a);function a(){return Object(c.a)(this,a),t.apply(this,arguments)}return Object(s.a)(a,[{key:"render",value:function(){var e=this;return r.a.createElement(Ne.a.Container,{key:"Tab.Container"+this.props.data.number,id:"left-tabs-example",defaultActiveKey:"rco1",style:{backgroundColor:"white"}},r.a.createElement(Se.a,{fill:!0,variant:"pills",className:"flex"},this.props.data.map((function(e){return r.a.createElement(Se.a.Item,{key:"Nav.Item rco".concat(e.number)},r.a.createElement(Se.a.Link,{style:{padding:".30rem"},key:"rco".concat(e.number),eventKey:"rco".concat(e.number)},"rco".concat(e.number)))}))),r.a.createElement(Ne.a.Content,null,this.props.data.map((function(t){return r.a.createElement(Ne.a.Pane,{key:"tabPanse".concat(e.props.salleNumb).concat(t.number),eventKey:"rco".concat(t.number)},r.a.createElement(we,{key:"displayFerme".concat(e.props.salleNumb).concat(t.number),data:t,salleNumb:e.props.salleNumb,rcoNumb:t.number,validRef:e.props.validRef}))}))))}}]),a}(r.a.Component),Ae=a(51),Le=a(24),Pe=function(e){Object(i.a)(a,e);var t=Object(u.a)(a);function a(){return Object(c.a)(this,a),t.apply(this,arguments)}return Object(s.a)(a,[{key:"addSalle",value:function(){var e=this.props.session.addSalle();this.props.dispatch({type:"SET_SESSION_DATA",value:e})}},{key:"addRco",value:function(){var e=this.props.session.addRco();this.props.dispatch({type:"SET_SESSION_DATA",value:e})}},{key:"addFerme",value:function(){console.log("cliquer");var e=this.props.session.addFerme();this.props.dispatch({type:"SET_SESSION_DATA",value:e})}},{key:"render",value:function(){var e=this;return r.a.createElement(r.a.Fragment,null,r.a.createElement(Ae.a,{variant:"success",id:"dropdown-basic-button",title:"Que voulez-vous ajouter ?"},r.a.createElement(Le.a.Item,{onClick:function(){return e.addSalle()}},"Salle"),r.a.createElement(Le.a.Item,{onClick:function(){return e.addRco()}},"RCO"),r.a.createElement(Le.a.Item,{onClick:function(){return e.addFerme()}},"Ferme")))}}]),a}(r.a.Component),Fe=Object(p.b)((function(e){return{session:e.session}}))(Pe),Be=function(e){Object(i.a)(a,e);var t=Object(u.a)(a);function a(){return Object(c.a)(this,a),t.apply(this,arguments)}return Object(s.a)(a,[{key:"deleteSalle",value:function(){var e=this.props.session.deleteSalle();e&&this.props.dispatch({type:"SET_SESSION_DATA",value:e})}},{key:"deleteRco",value:function(){var e=this.props.session.deleteRco();this.props.dispatch({type:"SET_SESSION_DATA",value:e})}},{key:"deleteFerme",value:function(){var e=this.props.session.deleteFerme();this.props.dispatch({type:"SET_SESSION_DATA",value:e})}},{key:"render",value:function(){var e=this;return r.a.createElement(r.a.Fragment,null,r.a.createElement(Ae.a,{variant:"danger",id:"dropdown-basic-button",title:"Que voulez-vous supprimer?"},r.a.createElement(Le.a.Item,{onClick:function(){return e.deleteSalle()}},"Salle"),r.a.createElement(Le.a.Item,{onClick:function(){return e.deleteRco()}},"RCO"),r.a.createElement(Le.a.Item,{onClick:function(){return e.deleteFerme()}},"Ferme")))}}]),a}(r.a.Component),Ue=Object(p.b)((function(e){return{session:e.session}}))(Be),Ke=function(e){Object(i.a)(a,e);var t=Object(u.a)(a);function a(){return Object(c.a)(this,a),t.apply(this,arguments)}return Object(s.a)(a,[{key:"render",value:function(){return r.a.createElement(Ne.a.Container,{defaultActiveKey:"Ajouter",style:{backgroundColor:"white"}},r.a.createElement(Se.a,{fill:!0,variant:"pills",className:"flex"},r.a.createElement(Se.a.Item,null,r.a.createElement(Se.a.Link,{style:{padding:".30rem"},key:"Ajouter",eventKey:"Ajouter"},"Ajouter")),r.a.createElement(Se.a.Item,null,r.a.createElement(Se.a.Link,{style:{padding:".30rem"},key:"Supprimer",eventKey:"Supprimer"},"Supprimer"))),r.a.createElement(Ne.a.Content,null,r.a.createElement(Ne.a.Pane,{key:"Ajouter",eventKey:"Ajouter"},r.a.createElement("div",{style:{marginTop:"10px"}},r.a.createElement(Fe,{function:this.props.function}))),r.a.createElement(Ne.a.Pane,{key:"Supprimer",eventKey:"Supprimer"},r.a.createElement("div",{style:{marginTop:"10px"}},r.a.createElement(Ue,{function:this.props.function})))))}}]),a}(r.a.Component),Me=function(e){Object(i.a)(a,e);var t=Object(u.a)(a);function a(){return Object(c.a)(this,a),t.apply(this,arguments)}return Object(s.a)(a,[{key:"render",value:function(){var e=this.props,t=e.data,a=e.vButton,n=e.vRef,l=t.name,o=t.salle;return r.a.createElement("div",{className:"MyCard",style:{marginBottom:"5px"}},r.a.createElement("div",{className:"Bando-Titre2 rounded",style:{marginBottom:"1px"}},"Repartiteur de ",r.a.createElement("span",{style:{color:"red",textTransform:"lowerCase"}},l)),r.a.createElement(je.a,{justify:!0,defaultActiveKey:"salle1",id:"uncontrolled-tab-example",unmountOnExit:!0},o.map((function(e){return r.a.createElement(Ne.a,{key:"Salle"+e.number,eventKey:"salle".concat(e.number),title:"salle".concat(e.number)},r.a.createElement(De,{key:"rco"+e.number,data:e.rco,salleNumb:e.number,validRef:n}))})),r.a.createElement(Ne.a,{key:"0",eventKey:"+",title:"+/-"},r.a.createElement(Ke,{function:this.props.function}))),r.a.createElement("div",{className:"Bando-Titre2 rounded",style:{marginTop:"5px"}},r.a.createElement(T.a,{type:"button",className:"btn btn-primary",onClick:a,ref:n,size:"sm"},"Valider en base")))}}]),a}(r.a.Component);var He=function(){function e(t,a){var n=this;if(Object(c.a)(this,e),0!==t.length){var r=function(e){var t=[];return e.forEach((function(e){var a=e.ferme<10?"0"+e.ferme:e.ferme;t.push(Object(f.a)(Object(f.a)({},e),{},{position:parseInt(""+e.salle+e.rco+a+e.level)}))})),t.sort((function(e,t){return e.position-t.position})),t}(t).map((function(e){return e.status?e:Object(f.a)(Object(f.a)({},e),{},{status:"original"})}));this.brutdata=r,this.repName=a,this.rep=[new D(a,this.brutdata)],this.cd=a.slice(-2),this.salleNumber=this.rep[0].salle.length;var l=[];if(this.rep.forEach((function(e){e.salle.forEach((function(e){e.rco.forEach((function(t){t.ferme.forEach((function(a){if(8!==a.level.length)for(var r=function(r){void 0===a.level.find((function(e){return e.number===r}))&&l.push({tdpId:"",status:"ghost",cd:n.cd,ferme:a.number,found:void 0,level:r,option:null,rco:t.number,regletteNbr:"",regletteType:"x",rep:n.repName,salle:e.number,_id:n.cd+n.repName+e.number+t.number+a.number+r})},o=1;o<9;o++)r(o)}))}))}))})),l.length>0)return new e(t.concat(l),this.repName)}}return Object(s.a)(e,[{key:"getRcoNumber",value:function(e){return this.rep[0].salle[e].rco.length}},{key:"modifRegType",value:function(t,a){var n=this,r=Object(m.a)(this.brutdata);return t.forEach((function(e){var t=n.brutdata.findIndex((function(t){return t._id===e}));r[t]=Object(f.a)(Object(f.a)({},n.brutdata[t]),{},{regletteType:a,tdpId:"x"===n.regletteNbr?"":""+n.brutdata[t].rep+a+n.brutdata[t].regletteNbr})})),new e(r,this.repName)}},{key:"modifRegNbr",value:function(t,a){var n=this,r=Object(m.a)(this.brutdata);return t.forEach((function(e){var t=n.brutdata.findIndex((function(t){return t._id===e}));r[t]=Object(f.a)(Object(f.a)({},n.brutdata[t]),{},{regletteNbr:a,tdpId:""===n.regletteType?"":""+n.brutdata[t].rep+n.brutdata[t].regletteType+a})})),new e(r,this.repName)}},{key:"modifOption",value:function(t,a){var n=this,r=Object(m.a)(this.brutdata);return t.forEach((function(e){var t=n.brutdata.findIndex((function(t){return t._id===e}));r[t]=Object(f.a)(Object(f.a)({},n.brutdata[t]),{},{option:"null"===a?null:a})})),new e(r,this.repName)}},{key:"addSalle",value:function(){var t=parseInt(prompt("Quel est le num\xe9ro de la premi\xe8re ferme de la premi\xe8re rco?"));if(t<1||isNaN(t))return new e(this.brutdata,this.repName);for(var a=this.salleNumber+1,n=1;n<9;n++)this.brutdata.push({tdpId:"",status:"ghost",cd:this.cd,ferme:t,found:void 0,level:n,option:null,rco:1,regletteNbr:"",regletteType:"x",rep:this.repName,salle:a,_id:this.cd+this.rep+a+1+t+n});return new e(this.brutdata,this.repName)}},{key:"addRco",value:function(){var t=this.salleNumber>1?parseInt(prompt("dans quelle salle?")):1;if(isNaN(t<1||isNaN(t)||t>this.salleNumber))return new e(this.brutdata,this.repName);var a=parseInt(prompt("Quel est le num\xe9ro de la premi\xe8re ferme de cette rco?"));if(a<1||isNaN(a))return new e(this.brutdata,this.repName);for(var n=this.rep[0].salle[t-1].rco.length+1,r=1;r<9;r++)this.brutdata.push({status:"ghost",tdpId:"",cd:this.cd,ferme:a,found:void 0,level:r,option:null,rco:n,regletteNbr:"",regletteType:"x",rep:this.repName,salle:t,_id:this.cd+this.rep+t+n+a+r});return new e(this.brutdata,this.repName)}},{key:"addFerme",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;if(0===t&&(t=this.salleNumber>1?parseInt(prompt("dans quelle salle?")):1),t<1||isNaN(t)||t>this.salleNumber)return new e(this.brutdata,this.repName);var r=this.getRcoNumber(t-1);if(0===a&&(a=r>1?parseInt(prompt("dans quelle rco?")):1),a<1||isNaN(a)||a>r)return new e(this.brutdata,this.repName);0===n&&(n=parseInt(prompt("Quel est le num\xe9ro de la ferme ?")));var l=-1!==this.rep[0].salle[t-1].rco[a-1].ferme.findIndex((function(e){return e.number===n}));if(n<1||isNaN(n)||l)return new e(this.brutdata,this.repName);for(var o=1;o<9;o++)this.brutdata.push({tdpId:"",status:"ghost",cd:this.cd,ferme:n,found:void 0,level:o,option:null,rco:a,regletteNbr:"",regletteType:"x",rep:this.repName,salle:t,_id:this.cd+this.rep+t+r+n+o});return new e(this.brutdata,this.repName)}},{key:"deleteSalle",value:function(){var t=this.salleNumber;if(t>1){var a=[];return this.brutdata.forEach((function(e){e.salle!==t&&a.push(e)})),new e(a,this.repName)}alert("D\xe9sol\xe9, il faut au minimum 1 salle dans un rep!")}},{key:"deleteRco",value:function(){var t=this.salleNumber>1?parseInt(prompt("dans quelle salle?")):1;if(t>0||!isNaN(t)||t<=this.salleNumber){var a=this.rep[0].salle[t-1].rco.length;if(a>1){var n=[];return this.brutdata.forEach((function(e){e.salle===t&&e.rco===a||n.push(e)})),new e(n,this.repName)}}}},{key:"deleteFerme",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;if(0===t&&(t=this.salleNumber>1?parseInt(prompt("dans quelle salle?")):1),t<1||isNaN(t)||t>this.salleNumber)return new e(this.brutdata,this.repName);var r=this.getRcoNumber(t-1);if(0===a&&(a=r>1?parseInt(prompt("dans quelle rco?")):1),a<1||isNaN(a)||a>r)return new e(this.brutdata,this.repName);0===n&&(n=parseInt(prompt("Quel est le num\xe9ro de la ferme ?")));var l=-1!==this.rep[0].salle[t-1].rco[a-1].ferme.findIndex((function(e){return e.number===n}));if(n<1||isNaN(n)||!l)return new e(this.brutdata,this.repName);var o=[];return this.brutdata.forEach((function(e){e.salle===t&&e.rco===a&&e.ferme===n||o.push(e)})),new e(o,this.repName)}},{key:"creatNewRep",value:function(t){return new e([{tdpId:"",status:"ghost",cd:t.slice(-2),ferme:1,found:void 0,level:1,option:null,rco:1,regletteNbr:"",regletteType:"x",rep:t,salle:1,_id:t.slice(-2)+t+1+1+1+1}],t)}}]),e}();var Ve=function(e){Object(i.a)(a,e);var t=Object(u.a)(a);function a(e){var n;return Object(c.a)(this,a),(n=t.call(this,e)).handleRepChange=function(e){return n.setState({repName:e.target.value.toLowerCase()})},n.handle_valideClick=function(){if(n.props.mySession.brutdata.length){var e=function(e,t){var a=[],n=[],r=[];return t.forEach((function(t){if("ghost"===t.status&&""!==t.regletteNbr&&"x"!==t.regletteType)a.push(t);else if("original"===t.status&&function(e){return"x"!==e.regletteType&&""!==e.regletteNbr}(t)){var r=e.findIndex((function(e){return e._id===t._id}));t.regletteType===e[r].regletteType&&t.regletteNbr===e[r].regletteNbr&&t.option===e[r].option||n.push(t)}})),t.forEach((function(e){"original"===e.status&&""===e.regletteNbr&&"x"===e.regletteType&&r.push(e)})),e.forEach((function(e){-1===t.findIndex((function(t){return t._id===e._id}))&&r.push(e)})),{tCreatedElem:a,tEditedElem:n,tDeletedElem:r}}(n.props.myBrutData,n.props.mySession.brutdata),t=e.tCreatedElem,a=e.tEditedElem,r=e.tDeletedElem;if(0===t.length&&0===a.length&&0===r.length)alert("Tu n'as apporter aucune modif \xe0 ce rep...");else if(window.confirm("Tu es sur le point de modifier definitivement la base de donn\xe9e. Es-tu sur de vouloir continuer?")){n.props.dispatch({type:"UPDATE_LOADER",value:!0});try{var l=n.handleClick;t.forEach((function(e){return Reflect.deleteProperty(e,"_id")})),F("create","POST",t,(function(){F("update","PUT",a,(function(){F("delete","DELETE",r,(function(){alert("sauvegard\xe9 avec succes"),l()}))}))}))}catch(o){alert("Il y a eu un probleme: les donner n'ont pas \xe9t\xe9 sauvegard\xe9es")}}}else alert("Aucun rep a valider !")},n.handleClick=function(){n.props.loaderStatus||n.props.dispatch({type:"UPDATE_LOADER",value:!0}),n.props.dispatch({type:"RESET_SESSION"}),ge(n.state.repName,(function(e,t){if(e.err)n.props.dispatch({type:"UPDATE_LOADER",value:!1}),alert("une erreur c'est produite...");else if(e.data){var a=new He(e.data,t);if(a.rep){var r=Object(m.a)(a.brutdata);n.props.dispatch({type:"SET_BASE_DATA",value:r}),n.props.dispatch({type:"SET_SESSION_DATA",value:a})}else window.confirm("Le rep n'existe pas, voulez-vous le creer")&&n.props.dispatch({type:"SET_SESSION_DATA",value:a.creatNewRep(t)});n.props.dispatch({type:"UPDATE_LOADER",value:!1})}}))},n.SalleDisplayer=function(e){var t=e.data,a=e.vButton,n=e.vRef;return t.rep?r.a.createElement(Me,{data:t.rep[0],vButton:a,vRef:n}):null},n.handleKeyPress=function(e){"Enter"===e.key&&(n.handleClick(),n.buttonOK.current.focus())},n.state={repName:"",theSession:void 0},n.buttonOK=r.a.createRef(),n.validButton=r.a.createRef(),n}return Object(s.a)(a,[{key:"render",value:function(){var e=this;return r.a.createElement("div",null,r.a.createElement(O.a,null,r.a.createElement("div",{className:"input-group mb-3"},r.a.createElement("input",{type:"text",className:"form-control",onChange:this.handleRepChange,onKeyPress:function(t){return e.handleKeyPress(t)},placeholder:"Rep \xe0 cr\xe9er/modifier ex:cho94","aria-label":"ex:cho94","aria-describedby":"button-addon2"}),r.a.createElement("div",{className:"input-group-append"},r.a.createElement("button",{className:"btn btn-primary",ref:this.buttonOK,type:"button",id:"button-addon2",onClick:this.handleClick},"OK"))),r.a.createElement(this.SalleDisplayer,{data:this.props.mySession,vButton:this.handle_valideClick,vRef:this.validButton})))}}]),a}(r.a.Component),Ge=Object(y.h)(Object(p.b)((function(e){return{loaderSatus:e.mustLoad,mySession:e.session,myBrutData:e.baseBrutData}}))(Ve)),Je=function(e){Object(i.a)(a,e);var t=Object(u.a)(a);function a(){var e;Object(c.a)(this,a);for(var n=arguments.length,l=new Array(n),o=0;o<n;o++)l[o]=arguments[o];return(e=t.call.apply(t,[this].concat(l))).goToRecherche=function(){return r.a.createElement(W.b,{to:"/Recherche"})},e}return Object(s.a)(a,[{key:"render",value:function(){return r.a.createElement("div",null,r.a.createElement(p.a,{store:b},r.a.createElement(ue,null),r.a.createElement(W.a,null,r.a.createElement(y.d,null,r.a.createElement(y.b,{exact:!0,path:"/"},r.a.createElement(J,null)),r.a.createElement(y.b,{exact:!0,path:"/Shower"},r.a.createElement(se,null)),r.a.createElement(y.b,{exact:!0,path:"/CreatRep"},r.a.createElement(Oe,null)),r.a.createElement(y.b,{exact:!0,path:"/Displayer"},r.a.createElement(Ge,null))))))}}]),a}(r.a.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));o.a.render(r.a.createElement(r.a.StrictMode,null,r.a.createElement(Je,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[76,1,2]]]);
//# sourceMappingURL=main.466fb072.chunk.js.map